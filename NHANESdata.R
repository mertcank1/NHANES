library(nhanesA)
library(SASxport)
library("writexl")
nhanesTables('Q', 2015)
nhanesTableVars('Q', 'DPQ_I')
DPQ_E
nhanesTables('Q', 2005)
DPQ_D2005_2006 <- nhanes('DPQ_D')
Demo_D2005_2006 <- nhanes('DEMO_D')
nrow(Demo_D2005_2006)
year=rep("2005-2006",10348)
D2005_2006 <- merge(DPQ_D2005_2006, Demo_D2005_2006,by = "SEQN",all = TRUE)
DPQ_D2005_2006<-cbind(D2005_2006,year)
DPQ_D2007_2008 <- nhanes('DPQ_E')
Demo_D2007_2008 <- nhanes('DEMO_E')
nrow(Demo_D2007_2008)
year=rep("2007-2008",10149)
D2007_2008 <- merge(DPQ_D2007_2008, Demo_D2007_2008,by = "SEQN",all = TRUE)
DPQ_D2007_2008<-cbind(D2007_2008,year)
DPQ_D2009_2010 <- nhanes('DPQ_F')
Demo_D2009_2010 <- nhanes('DEMO_F')
nrow(Demo_D2009_2010)
year=rep("2009-2010",10537)
D2009_2010 <- merge(DPQ_D2009_2010, Demo_D2009_2010,by = "SEQN",all = TRUE)
DPQ_D2009_2010 <-cbind(D2009_2010,year)
DPQ_D2011_2012 <- nhanes('DPQ_G')
Demo_D2011_2012 <- nhanes('DEMO_G')
nrow(Demo_D2011_2012)
year=rep("2011-2012",9756)
D2011_2012 <- merge(DPQ_D2011_2012, Demo_D2011_2012,by = "SEQN",all = TRUE)
DPQ_D2011_2012<-cbind(D2011_2012,year)
DPQ_D2013_2014 <- nhanes('DPQ_H')
Demo_D2013_2014 <- nhanes('DEMO_H')
D2013_2014 <- merge(DPQ_D2013_2014, Demo_D2013_2014,by = "SEQN",all = TRUE)
year=rep("2013-2014",10175)
DPQ_D2013_2014<-cbind(D2013_2014,year)
DPQ_D2015_2016 <- nhanes('DPQ_I')
Demo_D2015_2016 <- nhanes('DEMO_I')
year=rep("2015-2016",9971)
D2015_2016 <- merge(DPQ_D2015_2016, Demo_D2015_2016,by = "SEQN",all = TRUE)
DPQ_D2015_2016<-cbind(D2015_2016,year)
DPQ_D2017_2020 <- read.xport("P_DPQ.XPT")
Demo_D2017_2020 <- read.xport("P_DEMO.XPT")
year=rep("2017-2020",15560)
D2017_2020 <- merge(DPQ_D2017_2020, Demo_D2017_2020,by = "SEQN",all = TRUE)
DPQ_D2017_2020<-cbind(D2017_2020,year)
data<-rbind(DPQ_D2005_2006,DPQ_D2007_2008,DPQ_D2009_2010,DPQ_D2011_2012,DPQ_D2015_2016,DPQ_D2017_2020)
write_xlsx(data, "C:\\Users\\Ali\\Desktop\\NHANESdemo.xlsx")

